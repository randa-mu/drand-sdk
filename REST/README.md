# drand REST API

## Overview
The `drand` REST API provides endpoints to retrieve verifiable random values derived from the next randomness beacon.

## Miscellaneous Endpoints

<details>
 <summary>
 <code>GET</code> <code><b>/{service}</b></code> <br />
 Output the parameters required for verification.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute          | Type         | Description                                                                     |
> |--------------------|--------------|---------------------------------------------------------------------------------|
> | `app_name`         | string       | Application name used during the randomness derivation.                         |
> | `network`          | object       | Information about the drand network used by the service.                        |
> | `derivation_paths` | object array | Contains the parameters used during the randomness derivation of each function. |

#### Usage
```bash
>>> curl -X GET "http://1.2.3.4/exampleService" -H "Authorization: Bearer <your_jwt_token>"
{
  "app_name": "exampleService",
  "network": {
      "public_key": "8d4dc143b2128e18b4cdace6e5abece8012bfeca48551a008a69a1bbc88b71d37da840d2c8b028170f0a8704c90c1617",
      "period": 30,
      "genesis_time": 1698856390,
      "genesis_seed": "36ab1415e2967a7571f70f88cbf733eb77ef1a3ed34173ecc5e7bac924aeb17f",
      "chain_hash": "f11df9e56edb49c6b049cd73a68214be4e879688fdd696f96f0750ad377f9be4",
      "scheme": "pedersen-bls-chained",
      "beacon_id": "default"
  },
  "derivation_paths": [
    {
      "fn": "uint32",
      "dst": "Uint32",
      "hash": "Shake128"
    },
    {
      "fn": "uint64",
      "dst": "Uint64",
      "hash": "Shake128"
    }
  ]
}
```

</details>

## Next Randomness Endpoints
The endpoints in this section are *blocking*. They shall wait until a new randomness beacon is generated by the drand network before returning an output.

These endpoints can output multiple values for one randomness beacon by specifying the optional parameter `n` in the body of the request.

<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/int/{bitsize}</b></code><br />
 Returns integers of <code>{bitsize}</code> bits derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.
- `bitsize` (path parameter, required): The size in bits of the random integers, must be one of the following: `8`, `16`, `32`, `64`, `128`, `256`

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute    | Type                  | Required | Default           | Description                                                                     |
> |--------------|-----------------------|----------|-------------------|---------------------------------------------------------------------------------|
> | `seed`       | Base64-encoded string | Yes      | n/a               | Customization data used to obtain a unique random value.                        |
> | `n`          | integer               | No       | 1                 | Number of values that should be output.                                         |
> | `signedness` | string                | No       | "signed"          | Either "unsigned" for an unsigned integer, or "signed" for a signed integer.    |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | array of integers     | Random integer.                                |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/unsigned/32" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ==", "n": 2}'
{
  "round": 12345,
  "randomness": [-2271373, 1100599]
}
```
</details><br />

<details> 
 <summary>
 <code>POST</code> <code><b>/{service}/next/in-range</b></code><br />
 Returns uint256 integers within a [min, max) range derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Default           | Description                                              |
> |-----------|-----------------------|----------|------------------------------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | n/a               | Customization data used to obtain a unique random value. |
> | `max`     | integer               | Yes      | n/a               | Maximum of the range (exclusive).                        |
> | `min`     | integer               | No       | 0                 | Minimum of the range.                                    |
> | `n`       | integer               | No       | 1                 | Number of values that should be output.                  |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | integer               | Random integer within the [min, max) interval. |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/in-range" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ==", "min": 0, "max": 1073741824}'
{
  "round": 12345,
  "randomness": [929561826]
}
```
</details><br />

<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/bytes/{length}</b></code><br />
 Returns <code>{length}</code> bytes derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.
- `length` (path parameter, required): Number of bytes requested.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Default           | Description                                              |
> |-----------|-----------------------|----------|-------------------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | n/a               | Customization data used to obtain a unique random value. |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random bytes were generated.|
> | `randomness` | Base64-encoded bytes  | Random bytes.                                  |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/bytes/64" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ=="}'
{
  "round": 12345,
  "randomness": "S2BtHuIgNRphZVuGTl/4tEvZ5i+ErBuu33bpJcDOxP83Z8lTunQ9XFRfTmesXolGU8QOLhY9/Ls/5AqC3LIIHQ=="
}
```
</details>
