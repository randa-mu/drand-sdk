# drand REST API

## Overview
The `drand` REST API provides endpoints to retrieve verifiable random values derived from the next randomness beacon.

## Miscellaneous Endpoints

<details>
 <summary>
 <code>GET</code> <code><b>/{service}</b></code> <br />
 Output the parameters required for verification.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute          | Type         | Description                                                                     |
> |--------------------|--------------|---------------------------------------------------------------------------------|
> | `app_name`         | string       | Application name used during the randomness derivation.                         |
> | `network`          | object       | Information about the drand network used by the service.                        |
> | `derivation_paths` | object array | Contains the parameters used during the randomness derivation of each function. |

#### Usage
```bash
>>> curl -X GET "http://1.2.3.4/exampleService" -H "Authorization: Bearer <your_jwt_token>"
{
  "app_name": "exampleService",
  "network": {
      "public_key": "8d4dc143b2128e18b4cdace6e5abece8012bfeca48551a008a69a1bbc88b71d37da840d2c8b028170f0a8704c90c1617",
      "period": 30,
      "genesis_time": 1698856390,
      "genesis_seed": "36ab1415e2967a7571f70f88cbf733eb77ef1a3ed34173ecc5e7bac924aeb17f",
      "chain_hash": "f11df9e56edb49c6b049cd73a68214be4e879688fdd696f96f0750ad377f9be4",
      "scheme": "pedersen-bls-chained",
      "beacon_id": "default"
  },
  "derivation_paths": [
    {
      "fn": "uint32",
      "dst": "Uint32",
      "hash": "Shake128"
    },
    {
      "fn": "uint64",
      "dst": "Uint64",
      "hash": "Shake128"
    }
  ]
}
```

</details>

## Next Randomness Endpoints
The endpoints in this section are *blocking*. They shall wait until a new randomness beacon is generated by the drand network before returning an output.

<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/uint32</b></code><br />
 Returns a uint32 derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | integer               | Random integer.                                |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/uint32" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ=="}'
{
  "round": 12345,
  "randomness": 3837753070
}
```
</details><br />


<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/uint64</b></code><br />
 Returns a uint64 derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | integer               | Random integer.                                |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/uint64" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ=="}'
{
  "round": 12345,
  "randomness": 3837753070
}
```
</details><br />

<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/uint128</b></code><br />
 Returns a uint128 derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | integer               | Random integer.                                |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/uint128" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ=="}'
{
  "round": 12345,
  "randomness": 3837753070
}
```
</details><br />


<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/uint256</b></code><br />
 Returns a uint256 derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | integer               | Random integer.                                |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/uint256" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ=="}'
{
  "round": 12345,
  "randomness": 3837753070
}
```
</details><br />


<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/in-range</b></code><br />
 Returns a uint256 within a [min, max) range derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |
> | `min`     | integer               | Yes      | Minimum of the range.                                    |
> | `max`     | integer               | Yes      | Maximum of the range (exclusive).                        |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | integer               | Random integer within the [min, max) interval. |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/in-range" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ==", "min": 0, "max": 1073741824}'
{
  "round": 12345,
  "randomness": 929561826
}
```

