# drand REST API

## Overview
The `drand` REST API provides endpoints to retrieve verifiable random values derived from the next randomness beacon.

## Miscellaneous Endpoints

<details>
 <summary>
 <code>GET</code> <code><b>/{service}</b></code> <br />
 Output the parameters required for verification.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute          | Type         | Description                                                                     |
> |--------------------|--------------|---------------------------------------------------------------------------------|
> | `app_name`         | string       | Application name used during the randomness derivation.                         |
> | `network`          | object       | Information about the drand network used by the service.                        |
> | `derivation_paths` | object array | Contains the parameters used during the randomness derivation of each function. |

#### Usage
```bash
>>> curl -X GET "http://1.2.3.4/exampleService" -H "Authorization: Bearer <your_jwt_token>"
{
  "app_name": "exampleService",
  "network": {
    "public_key": "83cf0f2896adee7eb8b5f01fcad3912212c437e0073e911fb90022d3e760183c8c4b450b6a0a6c3ac6a5776a2d1064510d1fec758c921cc22b0e17e63aaf4bcb5ed66304de9cf809bd274ca73bab4af5a6e9c76a4bc09e76eae8991ef5ece45a",
    "period": 3,
    "genesis_time": 1692803367,
    "hash": "52db9ba70e0cc0f6eaf7803dd07447a1f5477735fd3f661792ba94600c84e971",
    "groupHash": "f477d5c89f21a17c863a7f937c6a6d15859414d2be09cd448d4279af331c5d3e",
    "schemeID": "bls-unchained-g1-rfc9380",
    "metadata": {
      "beaconID": "quicknet"
    }
  },
  "derivation_paths": [
    {
      "fn": "uint32",
      "dst": "Uint32",
      "hash": "Shake128"
    },
    {
      "fn": "uint64",
      "dst": "Uint64",
      "hash": "Shake128"
    }
  ]
}
```

</details>

## Next Randomness Endpoints
The endpoints in this section are *blocking*. They shall wait until a new randomness beacon is generated by the drand network before returning an output.

<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/uint32</b></code><br />
 Returns a uint32 derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | Base64-encoded string | Random integer.                                |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/uint32" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ=="}'
{
  "round": 12345,
  "randomness": "QkJCQg=="
}
```
</details><br />


<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/uint64</b></code><br />
 Returns a uint64 derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | Base64-encoded string | Random integer.                                |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/uint64" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ=="}'
{
  "round": 12345,
  "randomness": "QkJCQg=="
}
```
</details><br />

<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/uint128</b></code><br />
 Returns a uint128 derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | Base64-encoded string | Random integer.                                |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/uint128" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ=="}'
{
  "round": 12345,
  "randomness": "QkJCQg=="
}
```
</details><br />


<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/uint256</b></code><br />
 Returns a uint256 derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | Base64-encoded string | Random integer.                                |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/uint256" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ=="}'
{
  "round": 12345,
  "randomness": "QkJCQg=="
}
```
</details><br />


<details>
 <summary>
 <code>POST</code> <code><b>/{service}/next/in-range</b></code><br />
 Returns a uint256 within a [min, max) range derived from the next randomness beacon.
 </summary>

##### Parameters

- `service` (path parameter, required): Name of the service.

##### Request Body

The endpoint expects a JSON body with the following attributes:

> | Attribute | Type                  | Required | Description                                              |
> |-----------|-----------------------|----------|----------------------------------------------------------|
> | `seed`    | Base64-encoded string | Yes      | Customization data used to obtain a unique random value. |
> | `min`     | Base64-encoded string | Yes      | Minimum of the range.                                    |
> | `max`     | Base64-encoded string | Yes      | Maximum of the range (exclusive).                        |

##### Responses

If successful, returns a `200 OK` status and a JSON object with the following attributes:
> | Attribute    | Type                  | Description                                    |
> |--------------|-----------------------|------------------------------------------------|
> | `round`      | integer               | Round at which the random value was generated. |
> | `randomness` | Base64-encoded string | Random integer within the [min, max) interval. |

#### Usage
```bash
>>> curl -X POST "http://1.2.3.4/exampleService/next/in-range" \
-H "Authorization: Bearer <your_jwt_token>" \
-H "Content-Type: application/json" \
-d '{"seed": "QUFBQQ==", "min": "AA==", "max": "/////w=="}'
{
  "round": 12345,
  "randomness": "QkJCQg=="
}
```

